"use strict";(self.webpackChunkangular_starter=self.webpackChunkangular_starter||[]).push([[179],{2437:(O,P,s)=>{s.d(P,{g:()=>M});var p=s(1993),o=s(4825),S=s(7398),c=s(9212),f=s(1356),A=s(707),g=s(6814);let M=(()=>{class u{constructor(C,E){this.ref=C,this.config=E,this.logoutTimer$=(0,o.H)(0,1e3).pipe((0,S.U)(T=>(this.config.data||60)-T)),this.logoutTimer$.pipe((0,p.sL)()).subscribe(T=>{T<=0&&this.logout()})}ngOnInit(){}logout(){this.ref.close(!0)}ngOnDestroy(){}static#t=this.\u0275fac=function(E){return new(E||u)(c.Y36(f.E7),c.Y36(f.S))};static#e=this.\u0275cmp=c.Xpm({type:u,selectors:[["app-logout-modal"]],decls:9,vars:3,consts:[["id","the_time"],[1,"p-dialog-footer","p-widget-content","ng-tns-c7-3","ng-star-inserted"],["type","button","pButton","","aria-label","Close","icon","fas fa-power-off","label","Log Out",1,"float-start","pull-left",3,"click"],["type","button","pButton","","icon","fas fa-angle-double-right","iconPos","right","label","Continue Working",3,"click"]],template:function(E,T){1&E&&(c.TgZ(0,"p"),c._uU(1," Your session is about to expire in "),c.TgZ(2,"span",0),c._uU(3),c.ALo(4,"async"),c.qZA(),c._uU(5," seconds, do you want to continue working?\n"),c.qZA(),c.TgZ(6,"div",1)(7,"button",2),c.NdJ("click",function(){return T.logout()}),c.qZA(),c.TgZ(8,"button",3),c.NdJ("click",function(){return T.ref.close()}),c.qZA()()),2&E&&(c.xp6(3),c.Oqu(c.lcZ(4,1,T.logoutTimer$)))},dependencies:[A.Hq,g.Ov],encapsulation:2})}return u})()},4182:(O,P,s)=>{s.d(P,{sM:()=>et,uh:()=>Z,e8:()=>q,jq:()=>B,L6:()=>ct,pV:()=>pt,kk:()=>W,m8:()=>F,Cm:()=>tt,JU:()=>nt,jU:()=>L,UG:()=>R,Z1:()=>_});var p=s(6814),o=s(9212);s(5300),s(6593);var x=s(4887),j=s(3904),r=s(1356);const I=[x.Bz,j.D,r.DL];let F=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=o.oAB({type:e});static#s=this.\u0275inj=o.cJS({providers:[p.uU,p.H9],imports:[p.ez,I,x.Bz,j.D,r.DL]})}return e})();const R=typeof process<"u"&&null!=process.versions&&null!=process.versions.node,L=!R;var m=s(4399);const _=e=>e+` | ${m.N.properties.appName}`;class tt extends x.sz{serialize(a){return this._withTrailingSlash(super.serialize(a))}_withTrailingSlash(a){const t=a.indexOf("?")>-1?"?":"#",n=a.split(t);return n[0].endsWith("/")||-1===a.substring(a.lastIndexOf("/")+1).indexOf(".")&&(n[0]+="/"),n.join(t)}}var K=s(1462),U=s(1474);let et=(()=>{class e{constructor(t){this.http=t,this.store=(0,K.W_)(this.http),this.users=this.store({uniqueId:"id",apiUrl:"https://jsonplaceholder.typicode.com/users"})}static#t=this.\u0275fac=function(n){return new(n||e)(o.LFG(U.eN))};static#e=this.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var st=s(5219),Y=s(7780);let nt=(()=>{class e{constructor(t,n){this.confirmationService=t,this.dom=n,this.uiStore=(0,K.$I)({},{persistId:"globalUIStore"})}updateAppModal(){this.confirmationService.confirm({message:"An update for this application is available, would you like to update?",header:"Confirmation",accept:()=>this.dom?.document?.location.reload()})}static#t=this.\u0275fac=function(n){return new(n||e)(o.LFG(st.YP),o.LFG(Y.vo))};static#e=this.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var ot=s(5619),X=s(3019),G=s(2438),it=s(1687),Q=s(7921),w=s(8753),rt=s(4664),b=s(7398),at=s(3997),k=s(2181),H=s(9397),lt=s(8180),ht=s(2437);let Z=(()=>{class e extends Y.V1{set token(t){this.localStorage.setItem("token",t)}get token(){return this.localStorage.getItem("token")}get user(){return this.localStorage.getItem("user",{isJson:!0})}set user(t){this.localStorage.setItem("user",t)}constructor(){super(),this.token$=this.localStorage.getItem$("token"),this.user$=this.localStorage.getItem$("user",{isJson:!0})}static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var B=function(e){return e[e.initial=0]="initial",e[e.loggedIn=1]="loggedIn",e[e.loggedOut=2]="loggedOut",e[e.sessionExpired=3]="sessionExpired",e}(B||{});let q=(()=>{class e{constructor(t,n,i,h,y,l){this.http=t,this.router=n,this.route=i,this.appStorage=h,this.dialogService=y,this.dom=l,this.authState$=new ot.X(B.initial),this.tokenRefreshInterval=60,this.idleDuration=300,this.logoutModalDuration=60,this.logoutModalVisible=!1,this.userActions$=this.dom.isBrowser&&this.dom.document?(0,X.T)((0,G.R)(document,"keypress"),(0,G.R)(document,"mousemove"),(0,G.R)(document,"click"),(0,G.R)(this.dom.document,"scroll")):(0,X.T)(),this.refreshEvent$=this.userActions$.pipe((0,Q.O)(0),(0,w.p)(1e3,void 0,{leading:!1,trailing:!0})),this.logoutTimerExpired$=this.refreshEvent$.pipe((0,rt.w)(()=>(0,it.F)(1e3)),(0,b.U)(d=>d>this.idleDuration),(0,Q.O)(!1),(0,at.x)(),(0,k.h)(d=>!!this.appStorage.token&&d&&!this.logoutModalVisible),(0,H.b)(()=>this.launchLogoutModal())),this.refreshToken$=this.refreshEvent$.pipe((0,w.p)(1e3*this.tokenRefreshInterval,void 0,{leading:!1,trailing:!0}),(0,k.h)(d=>!!d&&!!this.appStorage.token&&!this.logoutModalVisible),(0,H.b)(()=>this.refreshToken())),this.route.queryParams.pipe((0,lt.q)(1)).subscribe(d=>{d.token&&(this.appStorage.token=d.token)})}logIn(t){return(m.N.endpoints.apiUrl&&m.N.endpoints.authLogin?this.http.post(m.N.endpoints.apiUrl+m.N.endpoints.authLogin,t):this.http.get("assets/mock-data/login.json")).pipe((0,H.b)(i=>{this.appStorage.token=i.data.token,this.authState$.next(B.loggedIn),i.data.expirationSeconds&&(this.idleDuration=i.data.expirationSeconds)}))}refreshToken(){const t=m.N.endpoints.apiUrl&&m.N.endpoints.authTokenRefresh?this.http.post(m.N.endpoints.apiUrl+m.N.endpoints.authTokenRefresh,{}):this.http.post("https://jsonplaceholder.typicode.com/posts/",{}).pipe((0,b.U)(()=>({data:{token:"12345",userGuid:"12345"},success:!0,meta:{}})));return t.subscribe(n=>{this.appStorage.token&&(this.authState$.next(B.loggedIn),this.appStorage.token=n.data.token)},()=>this.logOut(B.sessionExpired)),t}launchLogoutModal(){this.logoutModalVisible=!0,this.dialogService.open(ht.g,{data:this.logoutModalDuration,header:"Warning",width:"70%",dismissableMask:!0}).onClose.subscribe(n=>{n?this.logOut(B.loggedOut):this.refreshToken(),this.logoutModalVisible=!1})}logOut(t){this.appStorage.token=null,this.logoutModalVisible=!1,this.authState$.next(t);const n="/"!==this.router.url&&"/login"!==this.router.url?this.router.url.split("?")[0]:null;this.router.navigate(["/login"],{queryParams:{returnUrl:n}})}static#t=this.\u0275fac=function(n){return new(n||e)(o.LFG(U.eN),o.LFG(x.F0),o.LFG(x.gz),o.LFG(Z),o.LFG(r.xA),o.LFG(Y.vo))};static#e=this.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ct=(()=>{class e{constructor(t){this.dom=t}handleError(t){throw L&&!t.errorMsg&&!t.hasOwnProperty("status")&&m.N.production&&(m.N.endpoints.errorPath&&this.logError(t),this.resetState(t)),L||console.error(t),t}resetState(t){L&&(console.error({error:t}),this.dom?.localStorage?.clear(),this.dom?.sessionStorage?.clear())}logError(t){if(!m.N.endpoints.apiUrl||!m.N.endpoints.errorPath)return;const n=new XMLHttpRequest,h={level:"Error",class:"",message:t.message,exception:t.stack};n.open("POST",m.N.endpoints.apiUrl+m.N.endpoints.errorPath,!0),n.setRequestHeader("Content-type","application/json;charset=UTF-8"),n.send(JSON.stringify(h))}static#t=this.\u0275fac=function(n){return new(n||e)(o.LFG(Y.vo))};static#e=this.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac})}return e})();var ut=s(2096),dt=s(8504),ft=s(6306);let pt=(()=>{class e{constructor(t,n,i){this.appStorage=t,this.auth=n,this.transferState=i}intercept(t,n){if(!R&&"GET"===t.method){const l=(0,o.Cb6)(t.url),d=this.transferState.get(l,null);if(d)return(0,ut.of)(new U.Zn({body:d,status:200}))}const i={};this.appStorage.token&&(i.Authorization="Bearer "+this.appStorage.token);const h=new U.WM(i);return n.handle(t.clone({headers:h})).pipe((0,H.b)(l=>{R&&l instanceof U.Zn&&(200===l.status||202===l.status)&&this.transferState.set((0,o.Cb6)(t.url),l.body)}),(0,ft.K)(l=>((401===l.status||403===l.status)&&this.sessionEnd(),(0,dt._)(l))))}sessionEnd(){this.auth.logOut(B.sessionExpired)}static#t=this.\u0275fac=function(n){return new(n||e)(o.LFG(Z),o.LFG(q),o.LFG(o.kie))};static#e=this.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac})}return e})();var W;!function(e){let a;var t;(t=a=e.Decision||(e.Decision={}))[t.defect=0]="defect",t[t.coop=1]="coop"}(W||(W={}))},5300:(O,P,s)=>{s.d(P,{X:()=>o});var p=s(9212);let o=(()=>{class S{transform(f,A=!1){if(!f||""===f)return f;let u,v,C,g=f.replace(/[^0-9]/g,""),M=!1;if("1"===g.charAt(0)&&11===g.length&&(M=!0,g=g.slice(1)),A)return g;switch(g.length){case 1:case 2:case 3:u=g;break;default:u=g.slice(0,3),v=g.slice(3)}return v?(v.length>3&&(v=v.slice(0,3)+"-"+v.slice(3,7)),C=("("+u+") "+v).trim().slice(0,14)):C="("+u,M?"1 "+C:C}static#t=this.\u0275fac=function(A){return new(A||S)};static#e=this.\u0275pipe=p.Yjl({name:"phoneNumber",type:S,pure:!0})}return S})()},4399:(O,P,s)=>{s.d(P,{N:()=>S});const S=(0,s(9517).Z)({appID:"pd",production:!1,properties:{appName:"Prisoner's Dilemma"},settings:{enableServiceWorker:!0,enableAppComms:!0,preloadRoutes:!1,obfuscate:!0},domains:{listenTo:["http://localhost:4200"]},endpoints:{envConfig:"http://localhost:4200/assets/mock-data/env-settings.json",apiUrl:null,authLogin:"http://localhost:4200/assets/mock-data/login.json",authTokenRefresh:null,versionPath:null,errorPath:null},state:{uiStoreBlacklist:[]},licenses:{vapid:{publicKey:"BIZ-IPJrxKxtdL9O9CnK42-XWcepJDPMQDfj8pb_vCfQxa7j1LoC4exdzZ5MhPWaF_5eWPglkj3V32xRswQEm6Q",privateKey:"jUOTBXqGGwElft-fTVBYb1BeLWrRhn2HgyJpXZBhgLo"},agGrid:"qwerty"}},{prod:!0})},977:(O,P,s)=>{var p=s(6593),o=s(9212),S=s(1474),c=s(349),f=s(4887),A=s(5219),g=s(1356),M=s(4399),u=s(4182),v=s(1993),C=s(7780);let E=(()=>{class r{constructor(I,F){this.auth=I,this.dom=F,this.dom.isBrowser&&(this.auth.logoutTimerExpired$.pipe((0,v.sL)()).subscribe(),this.auth.refreshToken$.pipe((0,v.sL)()).subscribe())}ngOnInit(){}ngOnDestroy(){}static#t=this.\u0275fac=function(F){return new(F||r)(o.Y36(u.e8),o.Y36(C.vo))};static#e=this.\u0275cmp=o.Xpm({type:r,selectors:[["app-root"]],decls:1,vars:0,template:function(F,R){1&F&&o._UZ(0,"router-outlet")},dependencies:[f.lC],encapsulation:2})}return r})();const T=[{path:"users",loadChildren:()=>Promise.all([s.e(81),s.e(95),s.e(107),s.e(592),s.e(231)]).then(s.bind(s,3231)).then(r=>r.UsersModule)},{path:"login",pathMatch:"full",loadChildren:()=>Promise.all([s.e(81),s.e(95),s.e(107),s.e(592),s.e(126)]).then(s.bind(s,4126)).then(r=>r.LoginModule),title:(0,u.Z1)("Please Log In")},{path:"",pathMatch:"full",loadChildren:()=>Promise.all([s.e(81),s.e(95),s.e(107),s.e(653),s.e(592),s.e(954)]).then(s.bind(s,5954)).then(r=>r.HomeModule)},{path:"**",loadChildren:()=>Promise.all([s.e(81),s.e(107),s.e(592),s.e(366)]).then(s.bind(s,366)).then(r=>r.NoContentModule),title:(0,u.Z1)("Page Not Found")}];let N=(()=>{class r{static#t=this.\u0275fac=function(F){return new(F||r)};static#e=this.\u0275mod=o.oAB({type:r});static#s=this.\u0275inj=o.cJS({imports:[f.Bz.forRoot(T,{useHash:!1,preloadingStrategy:M.N.settings.preloadRoutes?f.wm:f.GZ,scrollPositionRestoration:"enabled",initialNavigation:"enabledBlocking"}),f.Bz]})}return r})();const $=f.Bz.forChild([{path:"~",loadChildren:()=>Promise.all([s.e(81),s.e(107)]).then(s.bind(s,61)).then(r=>r.MasterPageModule)},{path:"~",loadChildren:()=>s.e(81).then(s.bind(s,3081)).then(r=>r.IconsComponent)},{path:"~",loadChildren:()=>s.e(95).then(s.bind(s,95)).then(r=>r.FormsModule)},{path:"~",loadChildren:()=>s.e(95).then(s.bind(s,95)).then(r=>r.ReactiveFormsModule)},{path:"~",loadChildren:()=>s.e(592).then(s.bind(s,4532)).then(r=>r.CardModule)},{path:"~",loadChildren:()=>s.e(502).then(s.bind(s,9502)).then(r=>r.MessagesModule)},{path:"~",loadChildren:()=>Promise.all([s.e(95),s.e(653),s.e(796),s.e(178)]).then(s.bind(s,3178)).then(r=>r.TableModule)},{path:"~",loadChildren:()=>Promise.all([s.e(796),s.e(526)]).then(s.bind(s,7526)).then(r=>r.TreeModule)}]);M.N.production&&(0,o.G48)();let x,j=(()=>{class r{constructor(I){this.injector=I,x=this.injector}static#t=this.\u0275fac=function(F){return new(F||r)(o.LFG(o.zs3))};static#e=this.\u0275mod=o.oAB({type:r,bootstrap:[E]});static#s=this.\u0275inj=o.cJS({providers:[(0,p.ly)(),A.YP,g.xA,{provide:f.Hx,useClass:u.Cm},{provide:o.qLn,useClass:u.L6},u.pV,{provide:S.TP,useClass:u.pV,multi:!0}],imports:[p.b2.withServerTransition({appId:M.N.appID}),S.JF,c.PW,$,N]})}return r})();M.N.production&&(0,o.G48)(),p.q6().bootstrapModule(j).catch(r=>console.log(r))}},O=>{O.O(0,[736],()=>O(O.s=977)),O.O()}]);