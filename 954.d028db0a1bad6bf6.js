"use strict";(self.webpackChunkangular_starter=self.webpackChunkangular_starter||[]).push([[954],{5954:(se,k,p)=>{p.r(k),p.d(k,{HomeModule:()=>ae});var C=p(2619),l=p(4182),h=p(6814),I=p(4887),_=p(5619),F=p(7398);const D={name:"Always Cooperates",fn:(o,s)=>l.kk.Decision.coop},U={name:"Always Defects",fn:(o,s)=>l.kk.Decision.defect},O={name:"Tit For Tat",fn:(o,s)=>0===o.round||x(o.playerHistory[s])===l.kk.Decision.coop?l.kk.Decision.coop:x(o.playerHistory[s])===l.kk.Decision.defect?l.kk.Decision.defect:(console.error("Unknown condition"),l.kk.Decision.coop)},x=o=>o[o.length-1],N={name:"Unforgiving",fn:(o,s)=>0===o.round?l.kk.Decision.coop:o.playerHistory[s].reduce((i,t)=>!0===i||t===l.kk.Decision.defect,!1)?l.kk.Decision.defect:l.kk.Decision.coop};var e=p(9212),d=p(95),T=p(707),b=p(5219),w=p(5640),v=p(3714),y=p(5389),Z=p(2332),S=p(2591);const J=["cb"];function G(o,s){if(1&o&&e._UZ(0,"span",10),2&o){const n=e.oxw(3);e.Q6J("ngClass",n.checkboxIcon)}}function M(o,s){1&o&&e._UZ(0,"CheckIcon",11),2&o&&e.Q6J("styleClass","p-checkbox-icon")}function B(o,s){if(1&o&&(e.ynx(0),e.YNc(1,G,1,1,"span",8)(2,M,1,1,"CheckIcon",9),e.BQk()),2&o){const n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",n.checkboxIcon),e.xp6(1),e.Q6J("ngIf",!n.checkboxIcon)}}function Q(o,s){}function H(o,s){1&o&&e.YNc(0,Q,0,0,"ng-template")}function q(o,s){if(1&o&&(e.TgZ(0,"span",12),e.YNc(1,H,1,0,null,13),e.qZA()),2&o){const n=e.oxw(2);e.xp6(1),e.Q6J("ngTemplateOutlet",n.checkboxIconTemplate)}}function P(o,s){if(1&o&&(e.ynx(0),e.YNc(1,B,3,2,"ng-container",5)(2,q,2,1,"span",7),e.BQk()),2&o){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",!n.checkboxIconTemplate),e.xp6(1),e.Q6J("ngIf",n.checkboxIconTemplate)}}const V=(o,s,n)=>({"p-checkbox-label":!0,"p-checkbox-label-active":o,"p-disabled":s,"p-checkbox-label-focus":n});function E(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"label",14),e.NdJ("click",function(t){e.CHM(n);const a=e.oxw(),c=e.MAs(3);return e.KtG(a.onClick(t,c,!0))}),e._uU(1),e.qZA()}if(2&o){const n=e.oxw();e.Tol(n.labelStyleClass),e.Q6J("ngClass",e.kEZ(5,V,n.checked(),n.disabled,n.focused)),e.uIk("for",n.inputId),e.xp6(1),e.Oqu(n.label)}}const L=(o,s,n)=>({"p-checkbox p-component":!0,"p-checkbox-checked":o,"p-checkbox-disabled":s,"p-checkbox-focused":n}),j=(o,s,n)=>({"p-highlight":o,"p-disabled":s,"p-focus":n}),Y={provide:d.NG_VALUE_ACCESSOR,useExisting:(0,e.Gpc)(()=>A),multi:!0};let A=(()=>{class o{cd;value;name;disabled;binary;label;ariaLabelledBy;ariaLabel;tabindex;inputId;style;styleClass;labelStyleClass;formControl;checkboxIcon;readonly;required;trueValue=!0;falseValue=!1;onChange=new e.vpe;inputViewChild;templates;checkboxIconTemplate;model;onModelChange=()=>{};onModelTouched=()=>{};focused=!1;constructor(n){this.cd=n}ngAfterContentInit(){this.templates.forEach(n=>{"icon"===n.getType()&&(this.checkboxIconTemplate=n.template)})}onClick(n,i,t){n.preventDefault(),!this.disabled&&!this.readonly&&(this.updateModel(n),t&&i.focus())}updateModel(n){let i;this.binary?(i=this.checked()?this.falseValue:this.trueValue,this.model=i,this.onModelChange(i)):(i=this.checked()?this.model.filter(t=>!Z.gb.equals(t,this.value)):this.model?[...this.model,this.value]:[this.value],this.onModelChange(i),this.model=i,this.formControl&&this.formControl.setValue(i)),this.onChange.emit({checked:i,originalEvent:n})}handleChange(n){this.readonly||this.updateModel(n)}onFocus(){this.focused=!0}onBlur(){this.focused=!1,this.onModelTouched()}focus(){this.inputViewChild?.nativeElement.focus()}writeValue(n){this.model=n,this.cd.markForCheck()}registerOnChange(n){this.onModelChange=n}registerOnTouched(n){this.onModelTouched=n}setDisabledState(n){this.disabled=n,this.cd.markForCheck()}checked(){return this.binary?this.model===this.trueValue:Z.gb.contains(this.value,this.model)}static \u0275fac=function(i){return new(i||o)(e.Y36(e.sBO))};static \u0275cmp=e.Xpm({type:o,selectors:[["p-checkbox"]],contentQueries:function(i,t,a){if(1&i&&e.Suo(a,b.jx,4),2&i){let c;e.iGM(c=e.CRH())&&(t.templates=c)}},viewQuery:function(i,t){if(1&i&&e.Gf(J,5),2&i){let a;e.iGM(a=e.CRH())&&(t.inputViewChild=a.first)}},hostAttrs:[1,"p-element"],inputs:{value:"value",name:"name",disabled:"disabled",binary:"binary",label:"label",ariaLabelledBy:"ariaLabelledBy",ariaLabel:"ariaLabel",tabindex:"tabindex",inputId:"inputId",style:"style",styleClass:"styleClass",labelStyleClass:"labelStyleClass",formControl:"formControl",checkboxIcon:"checkboxIcon",readonly:"readonly",required:"required",trueValue:"trueValue",falseValue:"falseValue"},outputs:{onChange:"onChange"},features:[e._Bn([Y])],decls:7,vars:26,consts:[[3,"ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","checkbox",3,"readonly","value","checked","disabled","focus","blur","change"],["cb",""],[1,"p-checkbox-box",3,"ngClass","click"],[4,"ngIf"],[3,"class","ngClass","click",4,"ngIf"],["class","p-checkbox-icon",4,"ngIf"],["class","p-checkbox-icon",3,"ngClass",4,"ngIf"],[3,"styleClass",4,"ngIf"],[1,"p-checkbox-icon",3,"ngClass"],[3,"styleClass"],[1,"p-checkbox-icon"],[4,"ngTemplateOutlet"],[3,"ngClass","click"]],template:function(i,t){if(1&i){const a=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"input",2,3),e.NdJ("focus",function(){return t.onFocus()})("blur",function(){return t.onBlur()})("change",function(u){return t.handleChange(u)}),e.qZA()(),e.TgZ(4,"div",4),e.NdJ("click",function(u){e.CHM(a);const f=e.MAs(3);return e.KtG(t.onClick(u,f,!0))}),e.YNc(5,P,3,2,"ng-container",5),e.qZA()(),e.YNc(6,E,2,9,"label",6)}2&i&&(e.Tol(t.styleClass),e.Q6J("ngStyle",t.style)("ngClass",e.kEZ(18,L,t.checked(),t.disabled,t.focused)),e.xp6(2),e.Q6J("readonly",t.readonly)("value",t.value)("checked",t.checked())("disabled",t.disabled),e.uIk("id",t.inputId)("name",t.name)("tabindex",t.tabindex)("aria-labelledby",t.ariaLabelledBy)("aria-label",t.ariaLabel)("aria-checked",t.checked())("required",t.required),e.xp6(2),e.Q6J("ngClass",e.kEZ(22,j,t.checked(),t.disabled,t.focused)),e.xp6(1),e.Q6J("ngIf",t.checked()),e.xp6(1),e.Q6J("ngIf",t.label))},dependencies:()=>[h.mk,h.O5,h.tP,h.PC,S.n],styles:["@layer primeng{.p-checkbox{display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;vertical-align:bottom;position:relative}.p-checkbox-disabled{cursor:default!important;pointer-events:none}.p-checkbox-box{display:flex;justify-content:center;align-items:center}p-checkbox{display:inline-flex;vertical-align:bottom;align-items:center}.p-checkbox-label{line-height:1}}\n"],encapsulation:2,changeDetection:0})}return o})(),$=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=e.oAB({type:o});static \u0275inj=e.cJS({imports:[h.ez,S.n,b.m8]})}return o})();function R(o,s){1&o&&e._UZ(0,"input",25)}function z(o,s){if(1&o&&(e.TgZ(0,"div",22)(1,"label",10),e._UZ(2,"p-checkbox",23),e._uU(3),e.qZA(),e.YNc(4,R,1,0,"input",24),e.qZA()),2&o){const n=s.$implicit,i=s.index,t=e.oxw();let a;e.Q6J("formGroupName",i),e.xp6(2),e.Q6J("binary",!0),e.xp6(1),e.hij(" ",t.strategies[i].name," "),e.xp6(1),e.Q6J("ngIf",null==(a=n.get("enabled"))?null:a.value)}}function X(o,s){if(1&o&&(e._uU(0),e.ALo(1,"number")),2&o){const n=e.oxw().$implicit;e.AsE(" ",n.label," (",e.lcZ(1,2,n.finalScore),") ")}}function K(o,s){if(1&o&&(e.TgZ(0,"tr")(1,"td",30),e._uU(2),e.qZA(),e.TgZ(3,"td",31),e._uU(4),e.qZA(),e.TgZ(5,"td",31),e._uU(6),e.qZA()()),2&o){const n=s.$implicit;e.xp6(2),e.Oqu(n.label),e.xp6(2),e.Oqu(n.myScore),e.xp6(2),e.Oqu(n.opponentScore)}}function W(o,s){1&o&&(e.TgZ(0,"p-accordionTab"),e.YNc(1,X,2,4,"ng-template",28),e.TgZ(2,"div")(3,"table",29)(4,"tbody"),e.SjG(5,K,7,3,"tr",null,e.ikw),e.qZA()()()()),2&o&&e.wJu(5,s.$implicit.opponents)}function ee(o,s){if(1&o&&(e.TgZ(0,"div",26)(1,"h2"),e._uU(2,"Scoring"),e.qZA(),e.TgZ(3,"p-accordion",27),e.SjG(4,W,7,0,"p-accordionTab",null,e.ikw),e.qZA()()),2&o){const n=s.ngIf;e.xp6(3),e.Q6J("multiple",!0),e.wJu(4,n)}}const te={round:0,playerHistory:[],score:[0,0]},ne=[{path:"",component:(()=>{class o{constructor(n){this.fb=n,this.gameState$=new _.X(te),this._scoring$=new _.X(null),this.scoring$=this._scoring$.pipe((0,F.U)(i=>i?Object.entries(i).map(t=>({label:t[0],finalScore:t[1].finalScore,opponents:Object.entries(t[1].games).map(a=>({label:a[0],myScore:a[1].myScore,opponentScore:a[1].opponentScore}))})).sort((t,a)=>a.finalScore-t.finalScore):null)),this.strategies=[O,U,D,N],this.strategiesModel=this.strategies.map(i=>[!0,1]),this.playerScore=this.strategies.reduce((i,t)=>(i[t.name]=0,i),{}),this.results=[],this.initializeForm()}ngOnInit(){this.startGame()}startGame(){console.time("Time Elapsed");const n=this.settingsForm.value,i=this.generateSelectedStrategiesArray(),t=i.reduce((c,u)=>({...c,[u.name]:{finalScore:0,currentPlayerIndex:0,numOfPlayers:c[u.name]?.numOfPlayers?c[u.name].numOfPlayers+1:1,games:{}}}),{}),a=n.playAgainstSelf?0:1;for(let c=0;c<(n.gamesCount??1);c++)for(let u=0;u<i.length;u++)for(let f=u+a;f<i.length;f++){const r=i[u],m=i[f];if(!m)break;const g=this.faceOff(r,m,n);t[r.name].games[m.name]||(t[r.name].games[m.name]={opponent:m.name,myScore:0,opponentScore:0}),t[m.name].games[r.name]||(t[m.name].games[r.name]={opponent:r.name,myScore:0,opponentScore:0}),console.log(r.name,t[r.name]),t[r.name].finalScore+=g.score[0],t[r.name].games[m.name].myScore+=g.score[0],t[r.name].games[m.name].opponentScore+=g.score[1],r.name!==m.name&&(t[m.name].finalScore+=g.score[1],t[m.name].games[r.name].myScore+=g.score[0],t[m.name].games[r.name].opponentScore+=g.score[1])}console.warn(t),this._scoring$.next(t),console.timeEnd("Time Elapsed")}faceOff(n,i,t){const a={round:0,playerHistory:[[],[]],score:[0,0]},c=[];for(let u=0;u<(t.roundsPerGame??200);u++){const f=n.fn(a,1),r=i.fn(a,0);f===l.kk.Decision.coop&&r===l.kk.Decision.coop?(a.score[0]+=t.pointsForBothCoop??3,a.score[1]+=t.pointsForBothCoop??3,c.push(["Both Coop",...a.score])):f===l.kk.Decision.defect&&r===l.kk.Decision.defect?(a.score[0]+=t.pointsForBothDefect??1,a.score[1]+=t.pointsForBothDefect??1,c.push(["Both Defect",...a.score])):f===l.kk.Decision.coop&&r===l.kk.Decision.defect?(a.score[0]+=t.pointsForOneCoop??0,a.score[1]+=t.pointsForOneDefect??5,c.push(["Player 1 Coops, Player 2 Defects",...a.score])):f===l.kk.Decision.defect&&r===l.kk.Decision.coop?(a.score[0]+=t.pointsForOneDefect??5,a.score[1]+=t.pointsForOneCoop??0,c.push(["Player 1 Defects, Player 2 Coops",...a.score])):console.error("Unknown condition"),a.round++,a.playerHistory[0].push(f),a.playerHistory[1].push(r)}return this.gameState$.next(a),a}initializeForm(){this.settingsForm=this.fb.group({gamesCount:1,roundsPerGame:20,pointsForBothCoop:3,pointsForBothDefect:1,pointsForOneDefect:5,pointsForOneCoop:0,playAgainstSelf:!0,noise:0,strategySelection:this.fb.array(this.strategies.map(n=>this.createStrategyFormGroup(n)))})}createStrategyFormGroup(n){return this.fb.group({enabled:!0,count:1,name:n.name})}generateSelectedStrategiesArray(){const n=this.settingsForm.get("strategySelection")?.value;let i=[];return n.forEach((t,a)=>{if(t.enabled&&t.count>0)for(let c=0;c<t.count;c++)i.push(this.strategies[a])}),i}get strategySelection(){return this.settingsForm.get("strategySelection")}ngOnDestroy(){}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(d.FormBuilder))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-home"]],decls:72,vars:6,consts:[[1,"container-fluid"],[1,"float-end"],["pButton","",3,"click"],[1,"settings"],[3,"formGroup"],[1,"row"],[1,"col","col-12","col-md-4"],["formArrayName","strategySelection"],["class","d-flex","style","min-height: 2rem; align-content: flex-start; flex-wrap: wrap",3,"formGroupName",4,"ngFor","ngForOf"],[1,"mt-3"],[1,"me-2",2,"min-width","200px"],["formControlName","playAgainstSelf",3,"binary"],["pInputText","","type","number","formControlName","gamesCount",1,"p-input"],["pInputText","","type","number","formControlName","roundsPerGame",1,"p-input"],["pInputText","","type","number","formControlName","noise",1,"p-input"],["pInputText","","type","number","formControlName","pointsForBothCoop",1,"p-input"],["pInputText","","type","number","formControlName","pointsForBothDefect",1,"p-input"],[1,"mb-3"],[1,"d-inline-block",2,"min-width","100px"],["pInputText","","type","number","formControlName","pointsForOneDefect",1,"mb-2"],["pInputText","","type","number","formControlName","pointsForOneCoop",1,"p-input"],["class","scoring",4,"ngIf"],[1,"d-flex",2,"min-height","2rem","align-content","flex-start","flex-wrap","wrap",3,"formGroupName"],["formControlName","enabled",3,"binary"],["type","number","style","width: 50px","pInputText","","formControlName","count",4,"ngIf"],["type","number","pInputText","","formControlName","count",2,"width","50px"],[1,"scoring"],[3,"multiple"],["pTemplate","header"],[1,"table","table-sm","table-striped","mb-0",2,"width","initial"],["width","200px"],["width","50px"]],template:function(i,t){1&i&&(e.TgZ(0,"app-masterpage")(1,"div",0)(2,"div",1)(3,"button",2),e.NdJ("click",function(){return t.startGame()}),e._uU(4,"Run Game"),e.qZA()(),e.TgZ(5,"h1"),e._uU(6,"Prisoner's Dilemma"),e.qZA(),e._UZ(7,"hr"),e.TgZ(8,"div",3)(9,"form",4)(10,"div",5)(11,"div",6)(12,"p")(13,"strong"),e._uU(14,"Strategies"),e.qZA()(),e.TgZ(15,"div",7),e.YNc(16,z,5,4,"div",8),e.qZA(),e._UZ(17,"hr"),e.TgZ(18,"p",9)(19,"label",10),e._UZ(20,"p-checkbox",11),e._uU(21," Play against self "),e.qZA(),e.TgZ(22,"small")(23,"em"),e._uU(24,"Have each strategy play against itself as well as opponents"),e.qZA()()()(),e.TgZ(25,"div",6)(26,"p")(27,"strong"),e._uU(28,"Game Settings"),e.qZA()(),e.TgZ(29,"p"),e._uU(30," # Of Games"),e._UZ(31,"br")(32,"input",12),e.qZA(),e.TgZ(33,"p"),e._uU(34," Rounds Per Game"),e._UZ(35,"br")(36,"input",13),e.qZA(),e.TgZ(37,"p"),e._uU(38," Noise"),e._UZ(39,"br")(40,"input",14),e._uU(41,"%"),e._UZ(42,"br"),e.TgZ(43,"small")(44,"em"),e._uU(45,"Randomly flip values this % of time"),e.qZA()()()(),e.TgZ(46,"div",6)(47,"p")(48,"strong"),e._uU(49,"Scoring"),e.qZA()(),e.TgZ(50,"p"),e._uU(51," Score for mutual cooperation"),e._UZ(52,"br")(53,"input",15),e.qZA(),e.TgZ(54,"p"),e._uU(55," Score for mutual defection"),e._UZ(56,"br")(57,"input",16),e.qZA(),e.TgZ(58,"div",17),e._uU(59," Scores for single defection"),e._UZ(60,"br"),e.TgZ(61,"div",18),e._uU(62,"Defector:"),e.qZA(),e._UZ(63,"input",19)(64,"br"),e.TgZ(65,"div",18),e._uU(66,"Cooperator:"),e.qZA(),e._UZ(67,"input",20)(68,"br"),e.qZA()()()()(),e._UZ(69,"hr"),e.YNc(70,ee,6,1,"div",21),e.ALo(71,"async"),e.qZA()()),2&i&&(e.xp6(9),e.Q6J("formGroup",t.settingsForm),e.xp6(7),e.Q6J("ngForOf",t.strategySelection.controls),e.xp6(4),e.Q6J("binary",!0),e.xp6(50),e.Q6J("ngIf",e.lcZ(71,4,t.scoring$)))},dependencies:[h.sg,h.O5,T.Hq,b.jx,w.f,d.\u0275NgNoValidate,d.DefaultValueAccessor,d.NumberValueAccessor,d.NgControlStatus,d.NgControlStatusGroup,d.FormGroupDirective,d.FormControlName,d.FormGroupName,d.FormArrayName,v.o,y.UQ,y.US,A,h.Ov,h.JJ],styles:["[_nghost-%COMP%]{display:block}  .p-inputtext{padding:.1rem .429rem}.strategy[_ngcontent-%COMP%]{width:10px;height:10px;display:inline-block;background:green}.strategy.defect[_ngcontent-%COMP%]{background:red}"],changeDetection:0})}return o})(),title:(0,l.Z1)("Home")}],oe=I.Bz.forChild(ne);var ie=p(9653);let ae=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[h.ez,l.m8,oe,C.eK,C.Uf,d.ReactiveFormsModule,d.FormsModule,T.hJ,v.j,ie.L$,y.fx,$]})}return o})()}}]);